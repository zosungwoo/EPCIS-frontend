<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>
    <script>
        var baseURL = "http://localhots:8080/epcis/query"
		    
        var params = $("#subscribeParam").val() + $("#pollParam").val();
        var url = baseURL. // replace("http", "ws"); //+ params;
                    
        socket = new WebSocket(url);
        
        socket.onopen = function(e) {
            $("#responseToast").find("strong").html("Connection established");
            $("#responseToast").find(".toast-body").html("Please wait for the server to send the data.");
            // responseToast.show();
        };

        socket.onmessage = function(event) {
            $("#responseToast").find("strong").html("Data received from server");
            $("#responseToast").find(".toast-body").html("Please check the editor");
            // responseToast.show();
            // jsonEditor.setValue(event.da1ta);
        };
        
        socket.onclose = function(event) {
            if (event.wasClean) {
                $("#responseToast").find("strong").html("Connection closed cleanly.");
                $("#responseToast").find(".toast-body").html(event.reason);
                // responseToast.show();
            } else {
                $("#responseToast").find("strong").html("Connection closed abruptly.");
                $("#responseToast").find(".toast-body").html("Connection died");
                // responseToast.show();
            }
            
            $("#pollParam").val("");
            $("button#subscribe-off-btn").removeClass("btn-info").addClass("btn-outline-info").prop("disabled", true);
            $("button#subscribe-on-btn").removeClass("btn-outline-info").addClass("btn-info").prop("disabled", false);
        };

        socket.onerror = function(error) {
            $("#errorToast").find("strong").html("An error occured");
            $("#errorToast").find(".toast-body").html("Please check the editor to see the error message");
            // errorToast.sho???zaZZZZZZZZZZZZZZZZZZZZZZZZw();
            if(typeof event != `undefined`)
                jsonEditor.setValue(event.message);
            else
                jsonEditor.setValue("Browser probably cannot establish connection with " + url);
            
            $("#pollParam").val("");
            $("button#subscribe-off-btn").removeClass("btn-info").addClass("btn-outline-info").prop("disabled", true);
            $("button#subscribe-on-btn").removeClass("btn-outline-info").addClass("btn-info").prop("disabled", false);
        };
    </script>
</head>
<body>
    
</body>
</html>